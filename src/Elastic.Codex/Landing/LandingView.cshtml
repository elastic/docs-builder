@inherits RazorSliceHttpResult<Elastic.Codex.Landing.LandingViewModel>
@using System.Linq
@using Elastic.Codex.Landing
@using Elastic.Codex.Navigation
@using Elastic.Documentation.Svg
@implements IUsesLayout<Elastic.Codex._Layout, GlobalLayoutViewModel>
@functions {
	public GlobalLayoutViewModel LayoutModel => Model.CreateGlobalLayoutModel();

	private static HtmlString GetIconSvg(string? icon, string? cssClass = null)
	{
		if (icon == null)
			return new HtmlString(EuiSvgIcons.GetIcon("question", cssClass)!);
		return new HtmlString(EuiSvgIcons.GetIcon(icon, cssClass) ?? EuiSvgIcons.GetIcon("question", cssClass)!);
	}
}
<section id="elastic-docs-v3" class="codex-landing codex-root-landing min-h-screen" style="background-color: #f8fafc; position: relative;">

	<div class="fixed inset-0 z-0"
		 style="background-image: linear-gradient(to right, #e7e5e4 1px, transparent 1px), linear-gradient(to bottom, #e7e5e4 1px, transparent 1px); background-size: 20px 20px; background-position: 0 0, 0 0; mask-image: repeating-linear-gradient(to right, black 0px, black 3px, transparent 3px, transparent 8px), repeating-linear-gradient(to bottom, black 0px, black 3px, transparent 3px, transparent 8px), radial-gradient(ellipse 70% 60% at 50% 0%, #000 60%, transparent 100%); -webkit-mask-image: repeating-linear-gradient(to right, black 0px, black 3px, transparent 3px, transparent 8px), repeating-linear-gradient(to bottom, black 0px, black 3px, transparent 3px, transparent 8px), radial-gradient(ellipse 70% 60% at 50% 0%, #000 60%, transparent 100%); mask-composite: intersect; -webkit-mask-composite: source-in;">
	</div>

	<div class="codex-hero flex flex-col px-4 pt-10 pb-20 items-center text-center max-w-4xl mx-auto" style="position: relative; z-index: 1;" hx-select-oob="#main-container">

		<div class="flex items-center justify-between gap-2 mb-10 w-full">
			<img src="@LayoutModel.Static("logo-elastic-horizontal-color.svg")" alt="Elastic" class="h-10"/>
			<div class="flex items-center gap-4">
				<a href="https://github.com/elastic/docs-builder" target="_blank" rel="noopener" class="text-subdued hover:text-ink-dark transition-colors" title="elastic/docs-builder">
					@GetIconSvg("logo_github", "size-5 icon-mono")
				</a>
				<a href="https://elastic.slack.com/archives/C0JF80CJZ" target="_blank" rel="noopener" class="text-subdued hover:text-ink-dark transition-colors" title="#docs">
					@GetIconSvg("logo_slack", "size-5 icon-mono")
				</a>
			</div>
		</div>
		
		<div class="codex-hero-content max-w-4xl">
			<h1 class="text-6xl md:text-7xl font-sans font-bold text-slate-900 tracking-tight mb-6">
				@(LayoutModel.HeaderTitle ?? LayoutModel.DocSetName)
			</h1>
			<p class="mt-6 text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed">
				Elastic's internal documentation platform. Discover docs, best practices, and resources across all teams and organizations.
			</p>
		</div>

		<div class="w-full max-w-xl mt-10 mb-10 border border-grey-20 rounded-lg p-4 bg-white shadow-2xl">
			<div class="flex items-center gap-3">
				<button type="button"
						aria-label="Search"
						onclick="document.dispatchEvent(new CustomEvent('modal-search:open'))"
						class="flex-1 select-none cursor-pointer relative flex items-center w-full px-3 py-2 h-10 border border-grey-20 rounded-md bg-grey-10 text-sm text-subdued hover:border-grey-40 transition-colors">
					@GetIconSvg("search", "w-4 h-4 mr-2 shrink-0")
					<span class="flex-1 text-left">Search</span>
					<span class="text-xs text-subdued">âŒ˜K</span>
				</button>
				<div class="text-subdued text-xs flex items-center">
					OR
				</div>
				<button type="button"
						aria-label="Ask AI"
						onclick="document.dispatchEvent(new CustomEvent('ask-ai:open'))"
						class="select-none cursor-pointer text-white text-nowrap font-sans rounded-full px-6 py-2 h-10 flex items-center gap-2 justify-center shrink-0 hover:opacity-90 transition-opacity"
						style="background: linear-gradient(131deg, #1750ba 2.98%, #731dcf 66.24%);">
					@GetIconSvg("ai", "w-4 h-4 icon-mono")
					Ask AI
				</button>
			</div>
		</div>


		<div class="flex gap-6 mt-6 text-slate-600">
			<a href="/r/codex-environments/get-started"
			   class="flex items-center gap-1.5 text-blue-elastic hover:underline">
				@GetIconSvg("plus", "w-4 h-4 fill-current")
				Add your docs
			</a>
			<a href="https://docs-v3-preview.elastic.dev/elastic/docs-builder/tree/main/syntax"
			   target="_blank"
			   rel="noopener"
			   class="flex items-center gap-1.5 text-blue-elastic hover:underline">
				@GetIconSvg("code", "w-4 h-4 fill-current")
				Explore the syntax
			</a>
		</div>
	</div>

	@{
		var totalGroups = Model.CodexNavigation?.GroupNavigations?.Count ?? 0;
		var totalDocSets = Model.CodexNavigation?.DocumentationSetInfos?.Count ?? 0;
		var totalPages = Model.CodexNavigation?.DocumentationSetInfos?.Sum(ds => ds.PageCount) ?? 0;
	}
	<div class="flex items-center justify-center gap-8 py-6 text-sm text-slate-500" style="position: relative; z-index: 1;">
		<div class="flex items-center gap-2">
			@GetIconSvg("cluster", "w-4 h-4 fill-current")
			<span><strong class="text-slate-700">@totalGroups</strong> groups</span>
		</div>
		<div class="w-px h-4 bg-slate-300"></div>
		<div class="flex items-center gap-2">
			@GetIconSvg("app_notebook", "w-4 h-4 fill-current")
			<span><strong class="text-slate-700">@totalDocSets</strong> documentation sets</span>
		</div>
		<div class="w-px h-4 bg-slate-300"></div>
		<div class="flex items-center gap-2">
			@GetIconSvg("documents", "w-4 h-4 fill-current")
			<span><strong class="text-slate-700">@totalPages.ToString("N0")</strong> pages</span>
		</div>
	</div>

	<div id="codex-grid" class="pt-8 pb-8 max-w-7xl p-4 mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" style="position: relative; z-index: 1;">
		@foreach (var group in Model.Groups)
		{
			@(await RenderPartialAsync(_CodexCard.Create(new CodexCardModel
			{
				Url = group.Url,
				Title = group.DisplayTitle,
				Description = group.Description,
				Icon = group.Icon,
				PageCount = group.DocumentationSetInfos.Sum(ds => ds.PageCount)
			})))
		}
		@foreach (var docSet in Model.UngroupedDocumentationSets)
		{
			@(await RenderPartialAsync(_CodexCard.Create(new CodexCardModel
			{
				Url = docSet.Url,
				Title = docSet.Title ?? docSet.Name,
				Description = docSet.Description,
				Icon = docSet.Icon,
				PageCount = docSet.PageCount
			})))
		}
	</div>
</section>
